# HTTP协议简介
- HTTP协议用于客户端和服务器端之间的通信；
- 通过请求和响应的交换完成通信；
- **HTTP是不保存状态的协议；为了实现保存状态的功能，引入了Cookie技术；**
- 请求URI(*统一资源标志符*)定位资源；
- 告知服务器意图的HTTP方法:
    + GET：获取资源
    + POST：传输实体主体
    + PUT：传输文件
    + HEAD：获取报文首部
    + DELETE：删除文件
    + OPTIONS：询问支持的方法
    + TRACE：追踪路径
    + CONNECT：要求用隧道协议连接代理
- 使用**方法**下达命令；
- **持久连接节省通信量；**
    + 只要任意一端没有明确提出断开连接，则保持TCP连接状态
    + 好处在于减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载
    + HTTP/1.1中，所有连接默认为持久连接
    + 管线化，pipelining，同时并行发送多个请求；
- **使用Cookie管理状态；**
    + 服务器端发送的响应报文中增加Set-Cookie首部字段信息，通知客户端保存Cookie
    + 下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入Cookie值后发送出去
    + 服务器根据请求中的Cookie信息，进行状态管理；
----
# HTTP报文
- 请求报文/响应报文
- 报文首部+报文主体；由回车+换行分隔；不一定有报文主体；
- 报文首部： 请求行/状态行 + 首部字段(请求首部字段/响应首部字段 + 通用首部字段 + 实体首部字段 + 其他)
- **编码提升传输速率**
    + 压缩传输的内容编码：常用**gzip/compress/deflate/identify**
    + 分割发送的**分块传输编码**：传输大容量数据时，通过把数据分割成多块，能够让浏览器逐步显示页面
- 发送多种数据的多部分对象集合：Content-type
- 获取部分内容的范围请求
    + 针对范围请求，响应会返回状态码为206 Partial Content的响应报文
    + 如果服务器无法响应范围请求，会返回状态码200 OK和完整的实体内容
- 内容协商返回最合适的内容
----
# HTTP状态码
- 状态码告知从服务器返回的请求结果； 三位数字 + 原因短语构成；
- 状态码的类别：

状态码|类别|原因短语
--|--|--
1XX|Informational(信息性状态码)|接受的请求正在梳理
2XX|Succcess(成功状态码)|请求正常处理完毕
3XX|Redirection(重定向状态码)|需要进行附加操作以完成请求
4XX|Client Error(客户端错误状态码)|服务器无法处理请求
5XX|Server Error(服务器错误状态码)|服务器处理请求出错

- 2XX 成功：
    + **200 OK**：表示从客户端发来的请求在服务器端被正常处理了
    + **204 No Content**：服务器接收的请求已成功处理，但是返回的响应报文不含实体的主体部分
    + **206 Partial Content**：客户端进行了范围请求，服务器端成功执行了请求
- 3XX 重定向：
    + **301 Moved Permanently**：永久性重定向
    + **302 Found**：临时性重定向
    + **303 See Other**：请求对应的资源存在着另一个URI，应使用GET方法定向获取请求的资源
    + **304 Not Modified**：客户端发送附带条件的请求时，服务器端允许请求访问资源，但因发生请求未满足条件的情况后，直接返回304
    + **307 Temporary Redirect**：临时重定向
- 4XX 客户端错误
    + **400 Bad Request**: 请求报文存在语法错误
    + **401 Unauthorized**: 表示请求需要通过HTTP认证，若之前已进行一次请求，则表示认证失败
    + **403 Forbidden**: 表示对请求资源的访问被服务器拒绝了
    + **404 Not Found**：表示服务器上无法找到请求的资源
- 5XX 服务器错误
    + **500 Internal Server Error**：服务器在执行请求时发生错误
    + **503 Service Unavailable**：表示服务器暂时处于超负载或正在进行停机维护，现在无法处理请求
----
# Web服务器
- 用单台虚拟主机实现多个域名
    + 发送HTTP请求时，必须在HOST首部内完整指定主机名和域名的URI
- 通信数据转发程序：代码、网关、隧道
    + 代理：
        + 代理不改变请求URI
        + 代理可级联，每次通过代码服务器转发请求时，会追加写入Via首部信息
        + 通过设置组织内部的代理服务器可做到针对特定URI的访问控制
        + 利用缓存技术减少网络带宽的流量
        + 缓存代理、透明代理
    + 网关：
        + 通过网关可以由HTTP请求转化为其他协议的通信
    + 隧道：
        + 确保客户端与服务器进行安全通信
- 保存资源的缓存
    + 缓存是指代理服务器与客户端本地保存的资源副本
    + 利用缓存可减少对源服务器的访问，因此可节省通信流量和通信时间
    + 缓存服务器是代理服务器的一种，归类在缓存代理类型中
    + 缓存的有效期限
    + 客户端的缓存
----
# HTTP报文首部
- 通用首部字段
- 请求首部字段
- 响应首部字段
- 实体首部字段
----
# HTTPS
- HTTP的缺点：
    + 通信使用明文，内容可能被窃听
        + TCP/IP是可能被窃听的网络
        + 加密处理防止被窃听
        + 通信加密：SSL/TLS
        + 内容加密
    + 不验证通信方的身份，有可能遭遇伪装
        + 任何人都可以发起请求
        + 查明对方的**证书**
    + 无法证明报文的完整性，有可能已遭篡改
        + 接收到的内容可能有误-中间人攻击
        + 如何防止篡改--散列值校验/数字签名

- HTTPS是身披SSL外壳的HTTP
- 为什么不一直使用HTTPS？
    + **加密通信会消耗更多的CPU和内存资源**，敏感信息使用HTTPS，否则使用HTTP
    + 节省证书开销