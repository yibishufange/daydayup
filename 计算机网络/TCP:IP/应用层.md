  \* [域名系统 DNS](#域名系统-dns)

  \* [动态主机配置协议 DHCP](#动态主机配置协议-dhcp)

  \* [其他协议](#其他协议)

  \* [浏览器页面请求过程](#浏览器页面请求过程)

# 域名系统 DNS

DNS 是一个分布式数据库，提供了主机名和 IP 地址之间相互转换的服务。这里的分布式数据库是指，每个站点只保留它自己的那部分数据。

域名具有层次结构，从上到下依次为：根域名、顶级域名、二级域名。

DNS 可以使用 UDP 或者 TCP 进行传输，使用的端口号都为 53。大多数情况下 DNS 使用 UDP 进行传输，这就要求域名解析器和域名服务器都必须自己处理超时和重传从而保证可靠性。在两种情况下会使用 TCP 进行传输：

- 如果返回的响应超过的 512 字节（UDP 最大只支持 512 字节的数据）。
- 区域传送（区域传送是主域名服务器向辅助域名服务器传送变化的那部分数据）。

# 动态主机配置协议 DHCP

DHCP (Dynamic Host Configuration Protocol) 提供了即插即用的连网方式，用户不再需要手动配置 IP 地址等信息。

DHCP 配置的内容不仅是 IP 地址，还包括子网掩码、网关 IP 地址。

DHCP 工作过程如下：

1. 客户端发送 Discover 报文，该报文的目的地址为 255.255.255.255:67，源地址为 0.0.0.0:68，被放入 UDP 中，该报文被广播到同一个子网的所有主机上。如果客户端和 DHCP 服务器不在同一个子网，就需要使用中继代理。
2. DHCP 服务器收到 Discover 报文之后，发送 Offer 报文给客户端，该报文包含了客户端所需要的信息。因为客户端可能收到多个 DHCP 服务器提供的信息，因此客户端需要进行选择。
3. 如果客户端选择了某个 DHCP 服务器提供的信息，那么就发送 Request 报文给该 DHCP 服务器。
4. DHCP 服务器发送 Ack 报文，表示客户端此时可以使用提供给它的信息。

---

# 其他协议

- 文件传输协议 FTP
- 远程登录协议 TELNET
- 电子邮件协议
  - 发送协议 SMTP
  - 读取协议 POP3和IMAP

---

# 浏览器页面请求过程

1、URL解析



- 地址解析：首先判断你输入的是一个合法的 URL 还是一个待搜索的关键词，并且根据你输入的内容进行自动完成、字符编码等操作；

- HSTS：由于安全隐患，会使用 HSTS 强制客户端使用 HTTPS 访问页面；

- 其他操作：浏览器还会进行一些额外的操作，比如安全检查、访问限制；

- 检查缓存：

  [检查缓存]: https://pic1.zhimg.com/80/v2-0489444034d569b37867e2e527a7d5d4_1440w.jpg

2、DNS查询

[DNS查询顺序]: https://pic2.zhimg.com/80/v2-4e68ba51d411b26b607307dbd83a97ed_1440w.png

浏览器缓存--操作系统缓存--路由器缓存--ISP DNS缓存--根域名服务器查询

3、TCP连接

TCP/IP 分为四层，在发送数据时，每层都要对数据进行封装：

[]: https://pic3.zhimg.com/80/v2-6e7f3f12f414b1e970467f50c0062c6e_1440w.jpg

- 应用层：发动HTTP请求，构造HTTP报文；
- 传输层：TCP传输报文；三次握手建立连接；为了传输方便，分割数据，进行编号；
- 网络层：路由查找目标地址，ARP协议查询MAC地址；
- 链路层：帧

4、服务器处理请求

[]: https://pic2.zhimg.com/80/v2-60d9db8bab62fc741d2e43afb36aea4d_1440w.jpg

- HTTPD：服务器监听，常用的Linux上的Apache和Nginx，以及windows上的IIS；它会监听得到的请求，然后开启一个子进程去处理这个请求。
- 处理请求：报文解析（请求方法、域名、路径等），验证；
- 重定向
- URL重写

5、浏览器接受响应

- 根据响应报文头里的状态码做不同的事；
- 如果响应资源压缩了，还要解压；
- 对响应资源进行缓存；
- 解析内容；

6、渲染页面